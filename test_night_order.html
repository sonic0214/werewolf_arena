<!DOCTYPE html>
<html>
<head>
    <title>夜间行动顺序测试</title>
    <meta charset="utf-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #1a1f2e;
            color: #e7e9ea;
        }
        .test-case {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #475569;
            border-radius: 8px;
            background: #334155;
        }
        .expected {
            color: #10b981;
            font-weight: bold;
        }
        .actual {
            color: #f59e0b;
            font-weight: bold;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
    </style>
</head>
<body>
    <h1>🌙 夜间行动显示顺序测试</h1>

    <div class="test-case">
        <h3>测试描述</h3>
        <p>测试夜间行动的显示顺序是否符合游戏逻辑：</p>
        <div class="expected">预期顺序：预言家查验 → 狼人击杀 → 医生保护</div>

        <h3>修复前问题</h3>
        <div class="error">
            ❌ 原顺序：狼人击杀 → 医生保护 → 预言家查验<br>
            这样导致用户先看到被淘汰的消息，然后才看到保护行动，逻辑混乱
        </div>

        <h3>修复后效果</h3>
        <div class="success">
            ✅ 新顺序：预言家查验 → 狼人击杀 → 医生保护<br>
            符合游戏时间顺序，用户体验更好
        </div>

        <h3>阶段状态更新</h3>
        <p>现在会按以下顺序更新阶段状态：</p>
        <ul>
            <li>🔍 预言家查验行动中 → 查验行动完成</li>
            <li>🗡️ 狼人击杀行动中 → 击杀行动完成</li>
            <li>🛡️ 医生保护行动中 → 保护行动完成</li>
        </ul>

        <h3>代码修改</h3>
        <p>在 <code>static/index_live.js</code> 的 <code>generateLiveMessages()</code> 方法中：</p>
        <ol>
            <li>重新排序夜间行动处理顺序</li>
            <li>动态计算夜间行动总数</li>
            <li>确保阶段状态按正确顺序更新</li>
        </ol>
    </div>

    <div class="test-case">
        <h3>验证方法</h3>
        <p>要验证此修复，请：</p>
        <ol>
            <li>启动Web服务器：<code>python3 web_server.py</code></li>
            <li>创建一个新游戏</li>
            <li>观看游戏直播页面</li>
            <li>观察夜间行动的消息顺序</li>
        </ol>

        <p>应该看到按正确顺序显示的夜间行动消息！</p>
    </div>

    <button onclick="window.close()" style="padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">
        关闭测试页面
    </button>
</body>
</html>